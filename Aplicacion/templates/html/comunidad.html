{% extends 'html/base.html' %}
{% load static %}

{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Comunidad</title>
    <link rel="stylesheet" href="{% static 'css/comunidad.css' %}">
</head>
<body>
    <h1>Comunidad WalkUp</h1>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ publicacion_form.as_p }}
        <button type="submit">Publicar</button>
    </form>

    <hr>

    {% for pub in publicaciones %}
    <div class="card">
        <div class="usuario">
            <strong>{{ pub.usuario.username }}</strong> — {{ pub.fecha_publicacion|date:"d M Y H:i" }}
        </div>

        <img src="{{ pub.imagen.url }}" alt="Imagen publicación" width="400">

        <div class="contenido">
            <p><strong>Ruta:</strong> {{ pub.ruta.nombre }}</p>
            <p>{{ pub.comentario }}</p>
        </div>

        <div class="comentarios">
            <h4>Comentarios:</h4>
            {% for com in pub.comentarios.all %}
                <p><b>{{ com.usuario.username }}</b>: {{ com.texto }}</p>
            {% empty %}
                <p>Sin comentarios aún.</p>
            {% endfor %}

            <form method="post">
                {% csrf_token %}
                {{ comentario_form.as_p }}
                <input type="hidden" name="publicacion_id" value="{{ pub.id }}">
                <button type="submit">Comentar</button>
            </form>
        </div>
    </div>
    <hr>
    {% endfor %}
</body>
</html>
